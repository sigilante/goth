# Grok Expert JSON AST Diagnostic Report

This document analyzes the JSON AST output generated by Grok Expert to identify documentation gaps and format issues.

## Test Results Summary

### Category: basic

| File | Status | Error/Output |
|------|--------|--------------|
| abs | PASS | 5 |
| add_one | PASS | 6 |
| double | PASS | 10 |
| identity | PASS | 5 |
| is_even | PASS | ⊥ |
| is_positive | PASS | ⊤ |
| max_two | PASS | <partial/1> |
| min_two | PASS | <partial/1> |
| sign | PASS | 1 |
| square | PASS | 25 |

### Category: recursion

| File | Status | Error/Output |
|------|--------|--------------|
| ackermann | FAIL (App format) | Multi-arg App instead of curried |
| collatz_len | PASS | 5 |
| digit_sum | PASS | 5 |
| factorial | PASS | 120 |
| fibonacci | PASS | 5 |
| gcd | FAIL (App format) | Multi-arg App instead of curried |
| hyperop | FAIL (App format) | Multi-arg App instead of curried |
| lcm | FAIL (App format) | Multi-arg App instead of curried |
| mccarthy91 | PASS | 91 |
| power | FAIL (App format) | Multi-arg App instead of curried |
| reverse_num | FAIL (App format) | Multi-arg App instead of curried |
| sudan | FAIL (App format) | Multi-arg App instead of curried |
| sum_to_n | PASS | 15 |
| tak | FAIL (App format) | Multi-arg App instead of curried |

### Category: higher_order

| File | Status | Error/Output |
|------|--------|--------------|
| all_positive | PASS | ⊤ |
| any_negative | PASS | ⊥ |
| apply_twice | PASS | 20 |
| compose | PASS | 100 |
| count_if | PASS | 2 |
| filter_positive | FAIL (JSON format) | Invalid type structure |
| fold_product | FAIL | Error: Cannot multiply non-numeric tensor |
| fold_sum | PASS | 15 |
| map_double | FAIL (JSON format) | Invalid type structure |
| pipeline | PASS | 20 |

### Category: numeric

| File | Status | Error/Output |
|------|--------|--------------|
| exp_taylor | FAIL (App format) | Multi-arg App instead of curried |
| gamma_fact | FAIL (undefined) | Undefined name: gamma |
| gamma_half | FAIL (undefined) | Undefined name: gamma |
| harmonic | FAIL (undefined) | Undefined name: float |
| pi_leibniz | FAIL (undefined) | Undefined name: float |
| product_range | FAIL | Error: Cannot multiply non-numeric tensor |
| sqrt_newton | FAIL (App format) | Multi-arg App instead of curried |
| sum_squares | PASS | 55 |

### Category: algorithms

| File | Status | Error/Output |
|------|--------|--------------|
| binary_search | FAIL (App format) | Multi-arg App instead of curried |
| count_primes | FAIL (App format) | Multi-arg App instead of curried |
| isPrime | FAIL (App format) | Multi-arg App instead of curried |
| isqrt | FAIL (undefined) | Undefined name: float |
| modpow | FAIL (App format) | Multi-arg App instead of curried |
| nth_prime | FAIL (App format) | Multi-arg App instead of curried |


## Summary Statistics

- **Total files**: 48
- **Passing**: 24 (50%)
- **Failing**: 24 (50%)

### Failure Breakdown

| Issue | Count | Percentage |
|-------|-------|------------|
| Multi-arg App (currying) | 15 | 31% |
| Invalid JSON structure | 2 | 4% |
| Undefined names | 5 | 10% |
| Other errors | 2 | 4% |

## Key Issues Identified

### 1. Function Application Format (Currying) - 15 failures

**Problem**: Grok used multi-argument application:
```json
{"App": [{"Name": "main"}, {"Idx": 0}, {"Idx": 1}]}
```

**Expected**: Goth uses curried (nested binary) application:
```json
{"App": [{"App": [{"Name": "main"}, {"Idx": 0}]}, {"Idx": 1}]}
```

**Recommendation**: Document that `App` is always a 2-element array `[function, argument]`, and multi-argument functions require nested `App` nodes.

### 2. Undefined Built-in Functions - 5 failures

Grok referenced functions that don't exist or have different names:
- `gamma` - Gamma function (not a builtin)
- `float` - Int to float conversion (not available)

**Recommendation**: Document available builtin functions and type conversion mechanisms.

### 3. Invalid JSON Structure - 2 failures

Some JSON structures used object syntax where arrays were expected.

**Recommendation**: Provide more examples of each AST node type with correct structure.

### 4. Other Errors - 2 failures

Various type errors and runtime issues similar to the code output.

## Comparison: Code vs JSON AST

| Metric | Code Output | JSON AST Output |
|--------|-------------|-----------------|
| Total files | 48 | 48 |
| Pass rate | 64% (31/48) | 50% (24/48) |
| `mod` operator issue | 6 failures | 0 failures (uses "Mod") |
| Currying issue | N/A | 15 failures |
| Parse errors | 3 | 2 |
| Undefined names | 3 | 5 |

## Conclusion

The JSON AST format fixes some issues (like `mod` keyword) but introduces new ones (currying format).
The main documentation gap is explaining that function application must be curried with nested `App` nodes.
